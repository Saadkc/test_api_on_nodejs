{"version":3,"file":"payload-transformer.js","names":["_objectAssign2","_interopRequireDefault","require","_contentTypes","_utils","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","Number","PayloadTransformer","toRequest","data","contentType","arguments","APPLICATION_JSON","includes","JSON","stringify","fromResponse","xhr","headers","parseResponseHeaders","getAllResponseHeaders","getResponseHeader","status","statusText","response","responseText","parse","rawHeaders","lines","replace","split","reduce","line","parts","shift","trim","objectAssign","toLowerCase","join","create","exports"],"sources":["../../../src/common/http-request/payload-transformer.js"],"sourcesContent":["import objectAssign from 'object-assign';\nimport { APPLICATION_JSON } from './content-types';\nimport { includes } from '../utils';\n\nexport default class PayloadTransformer {\n    /**\n     * @returns {PayloadTransformer}\n     */\n    static create() {\n        return new PayloadTransformer();\n    }\n\n    /**\n     * @param {Object} data\n     * @param {string} [contentType = APPLICATION_JSON]\n     * @returns {Object}\n     */\n    toRequest(data, contentType = APPLICATION_JSON) {\n        if (data && includes(contentType, APPLICATION_JSON)) {\n            return JSON.stringify(data);\n        }\n\n        return data;\n    }\n\n    /**\n     * @param {XMLHttpRequest} xhr\n     * @returns {Object}\n     * @property {Object} data\n     * @property {number} status\n     * @property {string} statusText\n     */\n    fromResponse(xhr) {\n        const headers = this.parseResponseHeaders(xhr.getAllResponseHeaders());\n        const contentType = xhr.getResponseHeader('Content-Type');\n        const { status, statusText } = xhr;\n\n        let data = 'response' in xhr ? xhr.response : xhr.responseText;\n\n        if (data && includes(contentType, APPLICATION_JSON)) {\n            data = JSON.parse(data);\n        }\n\n        return {\n            data, headers, status, statusText,\n        };\n    }\n\n    /**\n     * @private\n     * @param {string} rawHeaders\n     * @returns {Object}\n     */\n    parseResponseHeaders(rawHeaders) {\n        const lines = rawHeaders ? rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ').split(/\\r?\\n/) : [];\n\n        return lines.reduce((headers, line) => {\n            const parts = line.split(':');\n            const key = (parts.shift() || '').trim();\n\n            if (!key) {\n                return headers;\n            }\n\n            return objectAssign({}, headers, {\n                [key.toLowerCase()]: parts.join(':').trim(),\n            });\n        }, {});\n    }\n}\n"],"mappings":"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"}