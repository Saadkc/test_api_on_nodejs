{"version":3,"file":"payload-mapper.js","names":["_objectAssign","_interopRequireDefault","require","_utils","_addressMapper","_customerMapper","_metaMapper","_paymentMethodIdMapper","_storeMapper","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","call","Number","PayloadMapper","addressMapper","customerMapper","metaMapper","paymentMethodIdMapper","storeMapper","value","mapToPayload","data","authToken","_data$order","order","_data$payment","payment","_data$paymentMethod","paymentMethod","payload","objectAssign","amount","grandTotal","integerAmount","tax","taxTotal","bc_auth_token","currency","gateway","mapToId","notify_url","callbackUrl","order_id","orderId","toString","page_title","document","title","payment_method_id","id","reference_id","return_url","returnUrl","mapToBillingAddress","mapToCustomer","mapToMeta","mapToShippingAddress","mapToStore","_payment$formattedPay","formattedPayload","omitNil","create","AddressMapper","CustomerMapper","MetaMapper","PaymentMethodIdMapper","StoreMapper","exports"],"sources":["../../../src/payment/offsite-payment-mappers/payload-mapper.js"],"sourcesContent":["import objectAssign from 'object-assign';\nimport { omitNil, toString } from '../../common/utils';\nimport AddressMapper from './address-mapper';\nimport CustomerMapper from './customer-mapper';\nimport MetaMapper from './meta-mapper';\nimport PaymentMethodIdMapper from '../payment-method-mappers/payment-method-id-mapper';\nimport StoreMapper from './store-mapper';\n\nexport default class PayloadMapper {\n    /**\n     * @returns {PayloadMapper}\n     */\n    static create() {\n        const addressMapper = AddressMapper.create();\n        const customerMapper = CustomerMapper.create();\n        const metaMapper = MetaMapper.create();\n        const paymentMethodIdMapper = PaymentMethodIdMapper.create();\n        const storeMapper = StoreMapper.create();\n\n        return new PayloadMapper(addressMapper, customerMapper, metaMapper, paymentMethodIdMapper, storeMapper);\n    }\n\n    /**\n     * @param {AddressMapper} addressMapper\n     * @param {CustomerMapper} customerMapper\n     * @param {MetaMapper} metaMapper\n     * @param {PaymentMethodIdMapper} paymentMethodIdMapper\n     * @param {StoreMapper} storeMapper\n     * @returns {Object}\n     */\n    constructor(addressMapper, customerMapper, metaMapper, paymentMethodIdMapper, storeMapper) {\n        /**\n         * @private\n         * @type {AddressMapper}\n         */\n        this.addressMapper = addressMapper;\n\n        /**\n         * @private\n         * @type {CustomerMapper}\n         */\n        this.customerMapper = customerMapper;\n\n        /**\n         * @private\n         * @type {MetaMapper}\n         */\n        this.metaMapper = metaMapper;\n\n        /**\n         * @private\n         * @type {PaymentMethodIdMapper}\n         */\n        this.paymentMethodIdMapper = paymentMethodIdMapper;\n\n        /**\n         * @private\n         * @type {StoreMapper}\n         */\n        this.storeMapper = storeMapper;\n    }\n\n    /**\n     * @param {PaymentRequestData} data\n     * @returns {Object}\n     */\n    mapToPayload(data) {\n        const {\n            authToken, order = {}, payment = {}, paymentMethod = {},\n        } = data;\n\n        const payload = objectAssign(\n            {\n                amount: order.grandTotal ? order.grandTotal.integerAmount : null,\n                tax: order.taxTotal ? order.taxTotal.integerAmount : null,\n                bc_auth_token: authToken,\n                currency: order.currency,\n                gateway: this.paymentMethodIdMapper.mapToId(paymentMethod),\n                notify_url: order.callbackUrl,\n                order_id: order.orderId ? toString(order.orderId) : null,\n                page_title: document.title ? document.title : null,\n                payment_method_id: paymentMethod.id,\n                reference_id: order.orderId ? toString(order.orderId) : null,\n                return_url: paymentMethod.returnUrl || (order.payment ? order.payment.returnUrl : null),\n            },\n            this.addressMapper.mapToBillingAddress(data),\n            this.customerMapper.mapToCustomer(data),\n            this.metaMapper.mapToMeta(data),\n            this.addressMapper.mapToShippingAddress(data),\n            this.storeMapper.mapToStore(data),\n        );\n\n        const { formattedPayload = {} } = payment;\n\n        objectAssign(payload, formattedPayload);\n\n        return omitNil(payload);\n    }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,MAAA,GAAAD,OAAA;AACA,IAAAE,cAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,eAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,WAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,sBAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,YAAA,GAAAP,sBAAA,CAAAC,OAAA;AAAyC,SAAAD,uBAAAQ,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAAA,SAAAG,QAAAH,GAAA,sCAAAG,OAAA,wBAAAC,MAAA,uBAAAA,MAAA,CAAAC,QAAA,aAAAL,GAAA,kBAAAA,GAAA,gBAAAA,GAAA,WAAAA,GAAA,yBAAAI,MAAA,IAAAJ,GAAA,CAAAM,WAAA,KAAAF,MAAA,IAAAJ,GAAA,KAAAI,MAAA,CAAAG,SAAA,qBAAAP,GAAA,KAAAG,OAAA,CAAAH,GAAA;AAAA,SAAAQ,gBAAAC,QAAA,EAAAC,WAAA,UAAAD,QAAA,YAAAC,WAAA,eAAAC,SAAA;AAAA,SAAAC,kBAAAC,MAAA,EAAAC,KAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAD,KAAA,CAAAE,MAAA,EAAAD,CAAA,UAAAE,UAAA,GAAAH,KAAA,CAAAC,CAAA,GAAAE,UAAA,CAAAC,UAAA,GAAAD,UAAA,CAAAC,UAAA,WAAAD,UAAA,CAAAE,YAAA,wBAAAF,UAAA,EAAAA,UAAA,CAAAG,QAAA,SAAAC,MAAA,CAAAC,cAAA,CAAAT,MAAA,EAAAU,cAAA,CAAAN,UAAA,CAAAO,GAAA,GAAAP,UAAA;AAAA,SAAAQ,aAAAf,WAAA,EAAAgB,UAAA,EAAAC,WAAA,QAAAD,UAAA,EAAAd,iBAAA,CAAAF,WAAA,CAAAH,SAAA,EAAAmB,UAAA,OAAAC,WAAA,EAAAf,iBAAA,CAAAF,WAAA,EAAAiB,WAAA,GAAAN,MAAA,CAAAC,cAAA,CAAAZ,WAAA,iBAAAU,QAAA,mBAAAV,WAAA;AAAA,SAAAa,eAAAK,GAAA,QAAAJ,GAAA,GAAAK,YAAA,CAAAD,GAAA,oBAAAzB,OAAA,CAAAqB,GAAA,iBAAAA,GAAA,GAAAM,MAAA,CAAAN,GAAA;AAAA,SAAAK,aAAAE,KAAA,EAAAC,IAAA,QAAA7B,OAAA,CAAA4B,KAAA,kBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAA3B,MAAA,CAAA8B,WAAA,OAAAD,IAAA,KAAAE,SAAA,QAAAC,GAAA,GAAAH,IAAA,CAAAI,IAAA,CAAAN,KAAA,EAAAC,IAAA,oBAAA7B,OAAA,CAAAiC,GAAA,uBAAAA,GAAA,YAAAzB,SAAA,4DAAAqB,IAAA,gBAAAF,MAAA,GAAAQ,MAAA,EAAAP,KAAA;AAAA,IAEpBQ,aAAa;EAc9B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACI,SAAAA,cAAYC,aAAa,EAAEC,cAAc,EAAEC,UAAU,EAAEC,qBAAqB,EAAEC,WAAW,EAAE;IAAApC,eAAA,OAAA+B,aAAA;IACvF;AACR;AACA;AACA;IACQ,IAAI,CAACC,aAAa,GAAGA,aAAa;;IAElC;AACR;AACA;AACA;IACQ,IAAI,CAACC,cAAc,GAAGA,cAAc;;IAEpC;AACR;AACA;AACA;IACQ,IAAI,CAACC,UAAU,GAAGA,UAAU;;IAE5B;AACR;AACA;AACA;IACQ,IAAI,CAACC,qBAAqB,GAAGA,qBAAqB;;IAElD;AACR;AACA;AACA;IACQ,IAAI,CAACC,WAAW,GAAGA,WAAW;EAClC;;EAEA;AACJ;AACA;AACA;EAHInB,YAAA,CAAAc,aAAA;IAAAf,GAAA;IAAAqB,KAAA,EAIA,SAAAC,aAAaC,IAAI,EAAE;MACf,IACIC,SAAS,GACTD,IAAI,CADJC,SAAS;QAAAC,WAAA,GACTF,IAAI,CADOG,KAAK;QAALA,KAAK,GAAAD,WAAA,cAAG,CAAC,CAAC,GAAAA,WAAA;QAAAE,aAAA,GACrBJ,IAAI,CADmBK,OAAO;QAAPA,OAAO,GAAAD,aAAA,cAAG,CAAC,CAAC,GAAAA,aAAA;QAAAE,mBAAA,GACnCN,IAAI,CADiCO,aAAa;QAAbA,aAAa,GAAAD,mBAAA,cAAG,CAAC,CAAC,GAAAA,mBAAA;MAG3D,IAAME,OAAO,GAAG,IAAAC,qBAAY,EACxB;QACIC,MAAM,EAAEP,KAAK,CAACQ,UAAU,GAAGR,KAAK,CAACQ,UAAU,CAACC,aAAa,GAAG,IAAI;QAChEC,GAAG,EAAEV,KAAK,CAACW,QAAQ,GAAGX,KAAK,CAACW,QAAQ,CAACF,aAAa,GAAG,IAAI;QACzDG,aAAa,EAAEd,SAAS;QACxBe,QAAQ,EAAEb,KAAK,CAACa,QAAQ;QACxBC,OAAO,EAAE,IAAI,CAACrB,qBAAqB,CAACsB,OAAO,CAACX,aAAa,CAAC;QAC1DY,UAAU,EAAEhB,KAAK,CAACiB,WAAW;QAC7BC,QAAQ,EAAElB,KAAK,CAACmB,OAAO,GAAG,IAAAC,eAAQ,EAACpB,KAAK,CAACmB,OAAO,CAAC,GAAG,IAAI;QACxDE,UAAU,EAAEC,QAAQ,CAACC,KAAK,GAAGD,QAAQ,CAACC,KAAK,GAAG,IAAI;QAClDC,iBAAiB,EAAEpB,aAAa,CAACqB,EAAE;QACnCC,YAAY,EAAE1B,KAAK,CAACmB,OAAO,GAAG,IAAAC,eAAQ,EAACpB,KAAK,CAACmB,OAAO,CAAC,GAAG,IAAI;QAC5DQ,UAAU,EAAEvB,aAAa,CAACwB,SAAS,KAAK5B,KAAK,CAACE,OAAO,GAAGF,KAAK,CAACE,OAAO,CAAC0B,SAAS,GAAG,IAAI;MAC1F,CAAC,EACD,IAAI,CAACtC,aAAa,CAACuC,mBAAmB,CAAChC,IAAI,CAAC,EAC5C,IAAI,CAACN,cAAc,CAACuC,aAAa,CAACjC,IAAI,CAAC,EACvC,IAAI,CAACL,UAAU,CAACuC,SAAS,CAAClC,IAAI,CAAC,EAC/B,IAAI,CAACP,aAAa,CAAC0C,oBAAoB,CAACnC,IAAI,CAAC,EAC7C,IAAI,CAACH,WAAW,CAACuC,UAAU,CAACpC,IAAI,CAAC,CACpC;MAED,IAAAqC,qBAAA,GAAkChC,OAAO,CAAjCiC,gBAAgB;QAAhBA,gBAAgB,GAAAD,qBAAA,cAAG,CAAC,CAAC,GAAAA,qBAAA;MAE7B,IAAA5B,qBAAY,EAACD,OAAO,EAAE8B,gBAAgB,CAAC;MAEvC,OAAO,IAAAC,cAAO,EAAC/B,OAAO,CAAC;IAC3B;EAAC;IAAA/B,GAAA;IAAAqB,KAAA;IAxFD;AACJ;AACA;IACI,SAAA0C,OAAA,EAAgB;MACZ,IAAM/C,aAAa,GAAGgD,sBAAa,CAACD,MAAM,EAAE;MAC5C,IAAM9C,cAAc,GAAGgD,uBAAc,CAACF,MAAM,EAAE;MAC9C,IAAM7C,UAAU,GAAGgD,mBAAU,CAACH,MAAM,EAAE;MACtC,IAAM5C,qBAAqB,GAAGgD,8BAAqB,CAACJ,MAAM,EAAE;MAC5D,IAAM3C,WAAW,GAAGgD,oBAAW,CAACL,MAAM,EAAE;MAExC,OAAO,IAAIhD,aAAa,CAACC,aAAa,EAAEC,cAAc,EAAEC,UAAU,EAAEC,qBAAqB,EAAEC,WAAW,CAAC;IAC3G;EAAC;EAAA,OAAAL,aAAA;AAAA;AAAAsD,OAAA,CAAA3F,OAAA,GAAAqC,aAAA"}